  <div class="background-network">
    <div class="top-producteur">
      <h1><%= @network.name %></h1>
    </div>

    <div class="container_producteur">
      <div class="show_producteur">
        <% @network_farmers.each do |farmer| %>
          <div class="show_pdt shadow">
            <%= cl_image_tag farmer.photo.last.key %>
            <div style="margin-top: 10px; margin-bottom: 10px;">
              <%= farmer.name %>
            </div>
          </div>
        <% end %>
      </div>
    </div>

    <div class="row">
      <div class="col-md-9">
        <div class="container-produit-network">
          <% @network_farmers.each do |farmer| %>
            <% farmer.ingredients.each do |ingredient| %>
              <div class="card-product-network">
                <div class="photo-produits shadow">
                  <%= cl_image_tag ingredient.photo.first.key, height: 100, width: 100 %>
                </div>

                <div class="dnd p-3 mt-2 text-center shadow">
                  <h5><%= ingredient.name %></h5>
                  <h5>Prix : <%= ingredient.price %>€</h5>

                    <%= simple_form_for @cart_item, url: carts_items_path(network_id: farmer.network, ingredient_id: ingredient), html: { class: 'simple-form' } do |f| %>
                      <div class="form_product_quantity" style="display: flex; align-items: center;">
                        <button type="button" onclick="decrementQuantity('<%= f.object_id %>')" class="quantity-modifier quantity-decrement tamereettonpere">-</button>
                        <%= f.input :quantity, as: :numeric, input_html: { id: "quantity_#{f.object_id}", value: 1, min: 1, class: 'quantity-input', style: "border: 0; outline: none; background-color: transparent; text-align: center; font-size: 20px;" }, label: false %>

                        <button type="button" onclick="incrementQuantity('<%= f.object_id %>')" class="quantity-modifier quantity-increment tamereettonpere">+</button>
                      </div>
                      <%= f.button :submit, "Ajouter au panier", class: "tamere" %>
                    <% end %>

                  </div>
                </div>
            <% end %>
          <% end %>
        </div>
      </div>
      <div class="col-md-3 fixed-div">
        <div class="top-cart">
          <h1>Panier</h1>
        </div>
        <div class="bottom-cart">
          <% if @cart %>
            <h2>Information panier :</h2>
            <% total_cart_price = 0 %>
            <% @cart.cart_items.each do |cart_item| %>
              <div>
                <% item_total_price = cart_item.ingredient.price * cart_item.quantity %>
                <p><%= cart_item.quantity %> x <%= cart_item.ingredient.name %> <%= item_total_price %>€   <%= link_to carts_item_path(cart_item), data: { turbo_method: :delete }, class: "btn" do %>
                  <i class="fa-solid fa-trash" style="color: #ff1900;"></i>
                <% end %></p>
                <% total_cart_price += item_total_price %>
              </div>
            <% end %>
            <p class="sum-of-all">Total: <%= total_cart_price.to_f %>€</p>
            <%= link_to "Mon Panier", carts_path, class: "link"%>
            <% else %>
              <p>Aucun panier </p>
            <% end %>
          </div>
      </div>
    </div>

    </div>



<script>
  function incrementQuantity(formId) {
    var input = document.getElementById("quantity_" + formId);
    var value = parseInt(input.value);
    input.value = value + 1;
  }

  function decrementQuantity(formId) {
    var input = document.getElementById("quantity_" + formId);
    var value = parseInt(input.value);
    if (value > 1) {
      input.value = value - 1;
    }
  }
</script>
